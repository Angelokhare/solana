{"version":3,"file":"Transport-B5tZgenk.js","names":["id","log","EventEmitter"],"sources":["../../@ledgerhq/errors/lib-es/helpers.js","../../@ledgerhq/errors/lib-es/index.js","../../@ledgerhq/logs/lib-es/index.js","../../@ledgerhq/hw-transport/lib-es/Transport.js"],"sourcesContent":["/* eslint-disable no-continue */\n/* eslint-disable no-unused-vars */\n/* eslint-disable no-param-reassign */\n/* eslint-disable no-prototype-builtins */\nconst errorClasses = {};\nconst deserializers = {};\nexport const addCustomErrorDeserializer = (name, deserializer) => {\n    deserializers[name] = deserializer;\n};\nexport const createCustomErrorClass = (name) => {\n    class CustomErrorClass extends Error {\n        cause;\n        constructor(message, fields, options) {\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            super(message || name, options);\n            // Set the prototype explicitly. See https://github.com/Microsoft/TypeScript/wiki/Breaking-Changes#extending-built-ins-like-error-array-and-map-may-no-longer-work\n            Object.setPrototypeOf(this, CustomErrorClass.prototype);\n            this.name = name;\n            if (fields) {\n                for (const k in fields) {\n                    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n                    // @ts-ignore\n                    this[k] = fields[k];\n                }\n            }\n            if (options && isObject(options) && \"cause\" in options && !this.cause) {\n                // .cause was specified but the superconstructor\n                // did not create an instance property.\n                const cause = options.cause;\n                this.cause = cause;\n                if (\"stack\" in cause) {\n                    this.stack = this.stack + \"\\nCAUSE: \" + cause.stack;\n                }\n            }\n        }\n    }\n    errorClasses[name] = CustomErrorClass;\n    return CustomErrorClass;\n};\nfunction isObject(value) {\n    return typeof value === \"object\";\n}\n// inspired from https://github.com/programble/errio/blob/master/index.js\nexport const deserializeError = (object) => {\n    if (object && typeof object === \"object\") {\n        try {\n            if (typeof object.message === \"string\") {\n                const msg = JSON.parse(object.message);\n                if (msg.message && msg.name) {\n                    object = msg;\n                }\n            }\n        }\n        catch (e) {\n            // nothing\n        }\n        let error;\n        if (typeof object.name === \"string\") {\n            const { name } = object;\n            const des = deserializers[name];\n            if (des) {\n                error = des(object);\n            }\n            else {\n                let constructor = name === \"Error\" ? Error : errorClasses[name];\n                if (!constructor) {\n                    console.warn(\"deserializing an unknown class '\" + name + \"'\");\n                    constructor = createCustomErrorClass(name);\n                }\n                error = Object.create(constructor.prototype);\n                try {\n                    for (const prop in object) {\n                        if (object.hasOwnProperty(prop)) {\n                            error[prop] = object[prop];\n                        }\n                    }\n                }\n                catch (e) {\n                    // sometimes setting a property can fail (e.g. .name)\n                }\n            }\n        }\n        else {\n            if (typeof object.message === \"string\") {\n                error = new Error(object.message);\n            }\n        }\n        if (error && !error.stack && Error.captureStackTrace) {\n            Error.captureStackTrace(error, deserializeError);\n        }\n        return error;\n    }\n    return new Error(String(object));\n};\n// inspired from https://github.com/sindresorhus/serialize-error/blob/master/index.js\nexport const serializeError = (value) => {\n    if (!value)\n        return value;\n    if (typeof value === \"object\") {\n        return destroyCircular(value, []);\n    }\n    if (typeof value === \"function\") {\n        return `[Function: ${value.name || \"anonymous\"}]`;\n    }\n    return value;\n};\n// https://www.npmjs.com/package/destroy-circular\nfunction destroyCircular(from, seen) {\n    const to = {};\n    seen.push(from);\n    for (const key of Object.keys(from)) {\n        const value = from[key];\n        if (typeof value === \"function\") {\n            continue;\n        }\n        if (!value || typeof value !== \"object\") {\n            to[key] = value;\n            continue;\n        }\n        if (seen.indexOf(from[key]) === -1) {\n            to[key] = destroyCircular(from[key], seen.slice(0));\n            continue;\n        }\n        to[key] = \"[Circular]\";\n    }\n    if (typeof from.name === \"string\") {\n        to.name = from.name;\n    }\n    if (typeof from.message === \"string\") {\n        to.message = from.message;\n    }\n    if (typeof from.stack === \"string\") {\n        to.stack = from.stack;\n    }\n    return to;\n}\n//# sourceMappingURL=helpers.js.map","import { serializeError, deserializeError, createCustomErrorClass, addCustomErrorDeserializer, } from \"./helpers\";\nexport { serializeError, deserializeError, createCustomErrorClass, addCustomErrorDeserializer };\nexport const AccountNameRequiredError = createCustomErrorClass(\"AccountNameRequired\");\nexport const AccountNotSupported = createCustomErrorClass(\"AccountNotSupported\");\nexport const AccountAwaitingSendPendingOperations = createCustomErrorClass(\"AccountAwaitingSendPendingOperations\");\nexport const AmountRequired = createCustomErrorClass(\"AmountRequired\");\nexport const BluetoothRequired = createCustomErrorClass(\"BluetoothRequired\");\nexport const BtcUnmatchedApp = createCustomErrorClass(\"BtcUnmatchedApp\");\nexport const CantOpenDevice = createCustomErrorClass(\"CantOpenDevice\");\nexport const CashAddrNotSupported = createCustomErrorClass(\"CashAddrNotSupported\");\nexport const ClaimRewardsFeesWarning = createCustomErrorClass(\"ClaimRewardsFeesWarning\");\nexport const CurrencyNotSupported = createCustomErrorClass(\"CurrencyNotSupported\");\nexport const DeviceAppVerifyNotSupported = createCustomErrorClass(\"DeviceAppVerifyNotSupported\");\nexport const DeviceGenuineSocketEarlyClose = createCustomErrorClass(\"DeviceGenuineSocketEarlyClose\");\nexport const DeviceNotGenuineError = createCustomErrorClass(\"DeviceNotGenuine\");\nexport const DeviceOnDashboardExpected = createCustomErrorClass(\"DeviceOnDashboardExpected\");\nexport const DeviceOnDashboardUnexpected = createCustomErrorClass(\"DeviceOnDashboardUnexpected\");\nexport const DeviceInOSUExpected = createCustomErrorClass(\"DeviceInOSUExpected\");\nexport const DeviceHalted = createCustomErrorClass(\"DeviceHalted\");\nexport const DeviceNameInvalid = createCustomErrorClass(\"DeviceNameInvalid\");\nexport const DeviceSocketFail = createCustomErrorClass(\"DeviceSocketFail\");\nexport const DeviceSocketNoBulkStatus = createCustomErrorClass(\"DeviceSocketNoBulkStatus\");\nexport const DeviceNeedsRestart = createCustomErrorClass(\"DeviceSocketNoBulkStatus\");\nexport const UnresponsiveDeviceError = createCustomErrorClass(\"UnresponsiveDeviceError\");\nexport const DisconnectedDevice = createCustomErrorClass(\"DisconnectedDevice\");\nexport const DisconnectedDeviceDuringOperation = createCustomErrorClass(\"DisconnectedDeviceDuringOperation\");\nexport const DeviceExtractOnboardingStateError = createCustomErrorClass(\"DeviceExtractOnboardingStateError\");\nexport const DeviceOnboardingStatePollingError = createCustomErrorClass(\"DeviceOnboardingStatePollingError\");\nexport const EnpointConfigError = createCustomErrorClass(\"EnpointConfig\");\nexport const EthAppPleaseEnableContractData = createCustomErrorClass(\"EthAppPleaseEnableContractData\");\nexport const SolAppPleaseEnableContractData = createCustomErrorClass(\"SolAppPleaseEnableContractData\");\nexport const CeloAppPleaseEnableContractData = createCustomErrorClass(\"CeloAppPleaseEnableContractData\");\nexport const FeeEstimationFailed = createCustomErrorClass(\"FeeEstimationFailed\");\nexport const FirmwareNotRecognized = createCustomErrorClass(\"FirmwareNotRecognized\");\nexport const HardResetFail = createCustomErrorClass(\"HardResetFail\");\nexport const InvalidXRPTag = createCustomErrorClass(\"InvalidXRPTag\");\nexport const InvalidAddress = createCustomErrorClass(\"InvalidAddress\");\nexport const InvalidNonce = createCustomErrorClass(\"InvalidNonce\");\nexport const InvalidAddressBecauseDestinationIsAlsoSource = createCustomErrorClass(\"InvalidAddressBecauseDestinationIsAlsoSource\");\nexport const LatestMCUInstalledError = createCustomErrorClass(\"LatestMCUInstalledError\");\nexport const LatestFirmwareVersionRequired = createCustomErrorClass(\"LatestFirmwareVersionRequired\");\nexport const UnsupportedFeatureError = createCustomErrorClass(\"UnsupportedFeatureError\");\nexport const NanoSNotSupported = createCustomErrorClass(\"NanoSNotSupported\");\nexport const UnknownMCU = createCustomErrorClass(\"UnknownMCU\");\nexport const LedgerAPIError = createCustomErrorClass(\"LedgerAPIError\");\nexport const LedgerAPIErrorWithMessage = createCustomErrorClass(\"LedgerAPIErrorWithMessage\");\nexport const LedgerAPINotAvailable = createCustomErrorClass(\"LedgerAPINotAvailable\");\nexport const ManagerAppAlreadyInstalledError = createCustomErrorClass(\"ManagerAppAlreadyInstalled\");\nexport const ManagerAppRelyOnBTCError = createCustomErrorClass(\"ManagerAppRelyOnBTC\");\nexport const ManagerAppDepInstallRequired = createCustomErrorClass(\"ManagerAppDepInstallRequired\");\nexport const ManagerAppDepUninstallRequired = createCustomErrorClass(\"ManagerAppDepUninstallRequired\");\nexport const ManagerDeviceLockedError = createCustomErrorClass(\"ManagerDeviceLocked\");\nexport const ManagerFirmwareNotEnoughSpaceError = createCustomErrorClass(\"ManagerFirmwareNotEnoughSpace\");\nexport const ManagerNotEnoughSpaceError = createCustomErrorClass(\"ManagerNotEnoughSpace\");\nexport const ManagerUninstallBTCDep = createCustomErrorClass(\"ManagerUninstallBTCDep\");\nexport const NetworkDown = createCustomErrorClass(\"NetworkDown\");\nexport const NetworkError = createCustomErrorClass(\"NetworkError\");\nexport const NoAddressesFound = createCustomErrorClass(\"NoAddressesFound\");\nexport const NotEnoughBalance = createCustomErrorClass(\"NotEnoughBalance\");\nexport const NotEnoughBalanceFees = createCustomErrorClass(\"NotEnoughBalanceFees\");\nexport const NotEnoughBalanceSwap = createCustomErrorClass(\"NotEnoughBalanceSwap\");\nexport const NotEnoughBalanceToDelegate = createCustomErrorClass(\"NotEnoughBalanceToDelegate\");\nexport const UnstakeNotEnoughStakedBalanceLeft = createCustomErrorClass(\"UnstakeNotEnoughStakedBalanceLeft\");\nexport const RestakeNotEnoughStakedBalanceLeft = createCustomErrorClass(\"RestakeNotEnoughStakedBalanceLeft\");\nexport const NotEnoughToRestake = createCustomErrorClass(\"NotEnoughToRestake\");\nexport const NotEnoughToUnstake = createCustomErrorClass(\"NotEnoughToUnstake\");\nexport const NotEnoughBalanceInParentAccount = createCustomErrorClass(\"NotEnoughBalanceInParentAccount\");\nexport const NotEnoughSpendableBalance = createCustomErrorClass(\"NotEnoughSpendableBalance\");\nexport const NotEnoughBalanceBecauseDestinationNotCreated = createCustomErrorClass(\"NotEnoughBalanceBecauseDestinationNotCreated\");\nexport const NotEnoughToStake = createCustomErrorClass(\"NotEnoughToStake\");\nexport const NoAccessToCamera = createCustomErrorClass(\"NoAccessToCamera\");\nexport const NotEnoughGas = createCustomErrorClass(\"NotEnoughGas\");\n// Error message specifically for the PTX swap flow\nexport const NotEnoughGasSwap = createCustomErrorClass(\"NotEnoughGasSwap\");\nexport const TronEmptyAccount = createCustomErrorClass(\"TronEmptyAccount\");\nexport const MaybeKeepTronAccountAlive = createCustomErrorClass(\"MaybeKeepTronAccountAlive\");\nexport const NotSupportedLegacyAddress = createCustomErrorClass(\"NotSupportedLegacyAddress\");\nexport const GasLessThanEstimate = createCustomErrorClass(\"GasLessThanEstimate\");\nexport const PriorityFeeTooLow = createCustomErrorClass(\"PriorityFeeTooLow\");\nexport const PriorityFeeTooHigh = createCustomErrorClass(\"PriorityFeeTooHigh\");\nexport const PriorityFeeHigherThanMaxFee = createCustomErrorClass(\"PriorityFeeHigherThanMaxFee\");\nexport const MaxFeeTooLow = createCustomErrorClass(\"MaxFeeTooLow\");\nexport const PasswordsDontMatchError = createCustomErrorClass(\"PasswordsDontMatch\");\nexport const PasswordIncorrectError = createCustomErrorClass(\"PasswordIncorrect\");\nexport const RecommendSubAccountsToEmpty = createCustomErrorClass(\"RecommendSubAccountsToEmpty\");\nexport const RecommendUndelegation = createCustomErrorClass(\"RecommendUndelegation\");\nexport const TimeoutTagged = createCustomErrorClass(\"TimeoutTagged\");\nexport const UnexpectedBootloader = createCustomErrorClass(\"UnexpectedBootloader\");\nexport const MCUNotGenuineToDashboard = createCustomErrorClass(\"MCUNotGenuineToDashboard\");\nexport const RecipientRequired = createCustomErrorClass(\"RecipientRequired\");\nexport const UnavailableTezosOriginatedAccountReceive = createCustomErrorClass(\"UnavailableTezosOriginatedAccountReceive\");\nexport const UnavailableTezosOriginatedAccountSend = createCustomErrorClass(\"UnavailableTezosOriginatedAccountSend\");\nexport const UpdateFetchFileFail = createCustomErrorClass(\"UpdateFetchFileFail\");\nexport const UpdateIncorrectHash = createCustomErrorClass(\"UpdateIncorrectHash\");\nexport const UpdateIncorrectSig = createCustomErrorClass(\"UpdateIncorrectSig\");\nexport const UpdateYourApp = createCustomErrorClass(\"UpdateYourApp\");\nexport const UserRefusedDeviceNameChange = createCustomErrorClass(\"UserRefusedDeviceNameChange\");\nexport const UserRefusedAddress = createCustomErrorClass(\"UserRefusedAddress\");\nexport const UserRefusedFirmwareUpdate = createCustomErrorClass(\"UserRefusedFirmwareUpdate\");\nexport const UserRefusedAllowManager = createCustomErrorClass(\"UserRefusedAllowManager\");\nexport const UserRefusedOnDevice = createCustomErrorClass(\"UserRefusedOnDevice\"); // TODO rename because it's just for transaction refusal\nexport const PinNotSet = createCustomErrorClass(\"PinNotSet\");\nexport const ExpertModeRequired = createCustomErrorClass(\"ExpertModeRequired\");\nexport const TransportOpenUserCancelled = createCustomErrorClass(\"TransportOpenUserCancelled\");\nexport const TransportInterfaceNotAvailable = createCustomErrorClass(\"TransportInterfaceNotAvailable\");\nexport const TransportRaceCondition = createCustomErrorClass(\"TransportRaceCondition\");\nexport const TransportWebUSBGestureRequired = createCustomErrorClass(\"TransportWebUSBGestureRequired\");\nexport const TransactionHasBeenValidatedError = createCustomErrorClass(\"TransactionHasBeenValidatedError\");\nexport const TransportExchangeTimeoutError = createCustomErrorClass(\"TransportExchangeTimeoutError\");\nexport const DeviceShouldStayInApp = createCustomErrorClass(\"DeviceShouldStayInApp\");\nexport const WebsocketConnectionError = createCustomErrorClass(\"WebsocketConnectionError\");\nexport const WebsocketConnectionFailed = createCustomErrorClass(\"WebsocketConnectionFailed\");\nexport const WrongDeviceForAccount = createCustomErrorClass(\"WrongDeviceForAccount\");\nexport const WrongDeviceForAccountPayout = createCustomErrorClass(\"WrongDeviceForAccountPayout\");\nexport const MissingSwapPayloadParamaters = createCustomErrorClass(\"MissingSwapPayloadParamaters\");\nexport const WrongDeviceForAccountRefund = createCustomErrorClass(\"WrongDeviceForAccountRefund\");\nexport const WrongAppForCurrency = createCustomErrorClass(\"WrongAppForCurrency\");\nexport const ETHAddressNonEIP = createCustomErrorClass(\"ETHAddressNonEIP\");\nexport const CantScanQRCode = createCustomErrorClass(\"CantScanQRCode\");\nexport const FeeNotLoaded = createCustomErrorClass(\"FeeNotLoaded\");\nexport const FeeNotLoadedSwap = createCustomErrorClass(\"FeeNotLoadedSwap\");\nexport const FeeRequired = createCustomErrorClass(\"FeeRequired\");\nexport const FeeTooHigh = createCustomErrorClass(\"FeeTooHigh\");\nexport const PendingOperation = createCustomErrorClass(\"PendingOperation\");\nexport const SyncError = createCustomErrorClass(\"SyncError\");\nexport const PairingFailed = createCustomErrorClass(\"PairingFailed\");\nexport const PeerRemovedPairing = createCustomErrorClass(\"PeerRemovedPairing\");\nexport const GenuineCheckFailed = createCustomErrorClass(\"GenuineCheckFailed\");\nexport const LedgerAPI4xx = createCustomErrorClass(\"LedgerAPI4xx\");\nexport const LedgerAPI5xx = createCustomErrorClass(\"LedgerAPI5xx\");\nexport const FirmwareOrAppUpdateRequired = createCustomErrorClass(\"FirmwareOrAppUpdateRequired\");\n// SpeedUp / Cancel EVM tx\nexport const ReplacementTransactionUnderpriced = createCustomErrorClass(\"ReplacementTransactionUnderpriced\");\n// Bitcoin family\nexport const OpReturnDataSizeLimit = createCustomErrorClass(\"OpReturnSizeLimit\");\nexport const DustLimit = createCustomErrorClass(\"DustLimit\");\n// Language\nexport const LanguageNotFound = createCustomErrorClass(\"LanguageNotFound\");\n// db stuff, no need to translate\nexport const NoDBPathGiven = createCustomErrorClass(\"NoDBPathGiven\");\nexport const DBWrongPassword = createCustomErrorClass(\"DBWrongPassword\");\nexport const DBNotReset = createCustomErrorClass(\"DBNotReset\");\nexport const SequenceNumberError = createCustomErrorClass(\"SequenceNumberError\");\nexport const DisabledTransactionBroadcastError = createCustomErrorClass(\"DisabledTransactionBroadcastError\");\n/**\n * Type of a Transport error used to represent all equivalent errors coming from all possible implementation of Transport\n */\nexport var HwTransportErrorType;\n(function (HwTransportErrorType) {\n    HwTransportErrorType[\"Unknown\"] = \"Unknown\";\n    HwTransportErrorType[\"LocationServicesDisabled\"] = \"LocationServicesDisabled\";\n    HwTransportErrorType[\"LocationServicesUnauthorized\"] = \"LocationServicesUnauthorized\";\n    HwTransportErrorType[\"BluetoothScanStartFailed\"] = \"BluetoothScanStartFailed\";\n})(HwTransportErrorType || (HwTransportErrorType = {}));\n/**\n * Represents an error coming from the usage of any Transport implementation.\n *\n * Needed to map a specific implementation error into an error that\n * can be managed by any code unaware of the specific Transport implementation\n * that was used.\n */\nexport class HwTransportError extends Error {\n    type;\n    constructor(type, message) {\n        super(message);\n        this.name = \"HwTransportError\";\n        this.type = type;\n        // Needed as long as we target < ES6\n        Object.setPrototypeOf(this, HwTransportError.prototype);\n    }\n}\n/**\n * TransportError is used for any generic transport errors.\n * e.g. Error thrown when data received by exchanges are incorrect or if exchanged failed to communicate with the device for various reason.\n */\nexport class TransportError extends Error {\n    id;\n    constructor(message, id) {\n        const name = \"TransportError\";\n        super(message || name);\n        this.name = name;\n        this.message = message;\n        this.stack = new Error(message).stack;\n        this.id = id;\n    }\n}\naddCustomErrorDeserializer(\"TransportError\", e => new TransportError(e.message, e.id));\nexport const StatusCodes = {\n    ACCESS_CONDITION_NOT_FULFILLED: 0x9804,\n    ALGORITHM_NOT_SUPPORTED: 0x9484,\n    CLA_NOT_SUPPORTED: 0x6e00,\n    CODE_BLOCKED: 0x9840,\n    CODE_NOT_INITIALIZED: 0x9802,\n    COMMAND_INCOMPATIBLE_FILE_STRUCTURE: 0x6981,\n    CONDITIONS_OF_USE_NOT_SATISFIED: 0x6985,\n    CONTRADICTION_INVALIDATION: 0x9810,\n    CONTRADICTION_SECRET_CODE_STATUS: 0x9808,\n    DEVICE_IN_RECOVERY_MODE: 0x662f,\n    CUSTOM_IMAGE_EMPTY: 0x662e,\n    FILE_ALREADY_EXISTS: 0x6a89,\n    FILE_NOT_FOUND: 0x9404,\n    GP_AUTH_FAILED: 0x6300,\n    HALTED: 0x6faa,\n    INCONSISTENT_FILE: 0x9408,\n    INCORRECT_DATA: 0x6a80,\n    INCORRECT_LENGTH: 0x6700,\n    INCORRECT_P1_P2: 0x6b00,\n    INS_NOT_SUPPORTED: 0x6d00,\n    DEVICE_NOT_ONBOARDED: 0x6d07,\n    DEVICE_NOT_ONBOARDED_2: 0x6611,\n    INVALID_KCV: 0x9485,\n    INVALID_OFFSET: 0x9402,\n    LICENSING: 0x6f42,\n    LOCKED_DEVICE: 0x5515,\n    MAX_VALUE_REACHED: 0x9850,\n    MEMORY_PROBLEM: 0x9240,\n    MISSING_CRITICAL_PARAMETER: 0x6800,\n    NO_EF_SELECTED: 0x9400,\n    NOT_ENOUGH_MEMORY_SPACE: 0x6a84,\n    OK: 0x9000,\n    PIN_REMAINING_ATTEMPTS: 0x63c0,\n    REFERENCED_DATA_NOT_FOUND: 0x6a88,\n    SECURITY_STATUS_NOT_SATISFIED: 0x6982,\n    TECHNICAL_PROBLEM: 0x6f00,\n    UNKNOWN_APDU: 0x6d02,\n    USER_REFUSED_ON_DEVICE: 0x5501,\n    NOT_ENOUGH_SPACE: 0x5102,\n    APP_NOT_FOUND_OR_INVALID_CONTEXT: 0x5123,\n    INVALID_APP_NAME_LENGTH: 0x670a,\n    GEN_AES_KEY_FAILED: 0x5419,\n    INTERNAL_CRYPTO_OPERATION_FAILED: 0x541a,\n    INTERNAL_COMPUTE_AES_CMAC_FAILED: 0x541b,\n    ENCRYPT_APP_STORAGE_FAILED: 0x541c,\n    INVALID_BACKUP_STATE: 0x6642,\n    PIN_NOT_SET: 0x5502,\n    INVALID_BACKUP_LENGTH: 0x6733,\n    INVALID_RESTORE_STATE: 0x6643,\n    INVALID_CHUNK_LENGTH: 0x6734,\n    INVALID_BACKUP_HEADER: 0x684a,\n    // Not documented:\n    TRUSTCHAIN_WRONG_SEED: 0xb007,\n};\nexport function getAltStatusMessage(code) {\n    switch (code) {\n        // improve text of most common errors\n        case 0x6700:\n            return \"Incorrect length\";\n        case 0x6800:\n            return \"Missing critical parameter\";\n        case 0x6982:\n            return \"Security not satisfied (dongle locked or have invalid access rights)\";\n        case 0x6985:\n            return \"Condition of use not satisfied (denied by the user?)\";\n        case 0x6a80:\n            return \"Invalid data received\";\n        case 0x6b00:\n            return \"Invalid parameter received\";\n        case 0x5515:\n            return \"Locked device\";\n    }\n    if (0x6f00 <= code && code <= 0x6fff) {\n        return \"Internal error, please report\";\n    }\n}\n/**\n * Error thrown when a device returned a non success status.\n * the error.statusCode is one of the `StatusCodes` exported by this library.\n */\nexport class TransportStatusError extends Error {\n    statusCode;\n    statusText;\n    /**\n     * @param statusCode The error status code coming from a Transport implementation\n     * @param options containing:\n     *  - canBeMappedToChildError: enable the mapping of TransportStatusError to an error extending/inheriting from it\n     *  . Ex: LockedDeviceError. Default to true.\n     */\n    constructor(statusCode, { canBeMappedToChildError = true } = {}) {\n        const statusText = Object.keys(StatusCodes).find(k => StatusCodes[k] === statusCode) || \"UNKNOWN_ERROR\";\n        const smsg = getAltStatusMessage(statusCode) || statusText;\n        const statusCodeStr = statusCode.toString(16);\n        const message = `Ledger device: ${smsg} (0x${statusCodeStr})`;\n        super(message);\n        this.name = \"TransportStatusError\";\n        this.statusCode = statusCode;\n        this.statusText = statusText;\n        Object.setPrototypeOf(this, TransportStatusError.prototype);\n        // Maps to a LockedDeviceError\n        if (canBeMappedToChildError && statusCode === StatusCodes.LOCKED_DEVICE) {\n            return new LockedDeviceError(message);\n        }\n    }\n}\nexport class LockedDeviceError extends TransportStatusError {\n    constructor(message) {\n        super(StatusCodes.LOCKED_DEVICE, { canBeMappedToChildError: false });\n        if (message) {\n            this.message = message;\n        }\n        this.name = \"LockedDeviceError\";\n        Object.setPrototypeOf(this, LockedDeviceError.prototype);\n    }\n}\nexport class DeviceMangementKitError extends Error {\n    constructor(name, message) {\n        super(message);\n        this.name = name;\n        Object.setPrototypeOf(this, DeviceMangementKitError.prototype);\n    }\n}\naddCustomErrorDeserializer(\"TransportStatusError\", e => new TransportStatusError(e.statusCode));\n//# sourceMappingURL=index.js.map","let id = 0;\nconst subscribers = [];\n/**\n * Logs something\n *\n * @param type a namespaced identifier of the log (it is not a level like \"debug\", \"error\" but more like \"apdu-in\", \"apdu-out\", etc...)\n * @param message a clear message of the log associated to the type\n */\nexport const log = (type, message, data) => {\n    const obj = {\n        type,\n        id: String(++id),\n        date: new Date(),\n    };\n    if (message)\n        obj.message = message;\n    if (data)\n        obj.data = data;\n    dispatch(obj);\n};\n/**\n * A simple tracer function, only expanding the existing log function\n *\n * Its goal is to capture more context than a log function.\n * This is simple for now, but can be improved later.\n *\n * @param context Anything representing the context where the log occurred\n */\nexport const trace = ({ type, message, data, context, }) => {\n    const obj = {\n        type,\n        id: String(++id),\n        date: new Date(),\n    };\n    if (message)\n        obj.message = message;\n    if (data)\n        obj.data = data;\n    if (context)\n        obj.context = context;\n    dispatch(obj);\n};\n/**\n * A simple tracer class, that can be used to avoid repetition when using the `trace` function\n *\n * Its goal is to capture more context than a log function.\n * This is simple for now, but can be improved later.\n *\n * @param type A given type (not level) for the current local tracer (\"hw\", \"withDevice\", etc.)\n * @param context Anything representing the context where the log occurred\n */\nexport class LocalTracer {\n    type;\n    context;\n    constructor(type, context) {\n        this.type = type;\n        this.context = context;\n    }\n    trace(message, data) {\n        trace({\n            type: this.type,\n            message,\n            data,\n            context: this.context,\n        });\n    }\n    getContext() {\n        return this.context;\n    }\n    setContext(context) {\n        this.context = context;\n    }\n    updateContext(contextToAdd) {\n        this.context = { ...this.context, ...contextToAdd };\n    }\n    getType() {\n        return this.type;\n    }\n    setType(type) {\n        this.type = type;\n    }\n    /**\n     * Create a new instance of the LocalTracer with an updated `type`\n     *\n     * It does not mutate the calling instance, but returns a new LocalTracer,\n     * following a simple builder pattern.\n     */\n    withType(type) {\n        return new LocalTracer(type, this.context);\n    }\n    /**\n     * Create a new instance of the LocalTracer with a new `context`\n     *\n     * It does not mutate the calling instance, but returns a new LocalTracer,\n     * following a simple builder pattern.\n     *\n     * @param context A TraceContext, that can undefined to reset the context\n     */\n    withContext(context) {\n        return new LocalTracer(this.type, context);\n    }\n    /**\n     * Create a new instance of the LocalTracer with an updated `context`,\n     * on which an additional context is merged with the existing one.\n     *\n     * It does not mutate the calling instance, but returns a new LocalTracer,\n     * following a simple builder pattern.\n     */\n    withUpdatedContext(contextToAdd) {\n        return new LocalTracer(this.type, { ...this.context, ...contextToAdd });\n    }\n}\n/**\n * Adds a subscribers to the emitted logs.\n *\n * @param cb that is called for each future log() with the Log object\n * @return a function that can be called to unsubscribe the listener\n */\nexport const listen = (cb) => {\n    subscribers.push(cb);\n    return () => {\n        const i = subscribers.indexOf(cb);\n        if (i !== -1) {\n            // equivalent of subscribers.splice(i, 1) // https://twitter.com/Rich_Harris/status/1125850391155965952\n            subscribers[i] = subscribers[subscribers.length - 1];\n            subscribers.pop();\n        }\n    };\n};\nfunction dispatch(log) {\n    for (let i = 0; i < subscribers.length; i++) {\n        try {\n            subscribers[i](log);\n        }\n        catch (e) {\n            console.error(e);\n        }\n    }\n}\nif (typeof window !== \"undefined\") {\n    window.__ledgerLogsListen = listen;\n}\n//# sourceMappingURL=index.js.map","import EventEmitter from \"events\";\nimport { TransportRaceCondition, TransportError, StatusCodes, getAltStatusMessage, TransportStatusError, } from \"@ledgerhq/errors\";\nimport { LocalTracer } from \"@ledgerhq/logs\";\nexport { TransportError, TransportStatusError, StatusCodes, getAltStatusMessage };\nconst DEFAULT_LOG_TYPE = \"transport\";\n/**\n * The Transport class defines a generic interface for communicating with a Ledger hardware wallet.\n * There are different kind of transports based on the technology (channels like U2F, HID, Bluetooth, Webusb) and environment (Node, Web,...).\n * It is an abstract class that needs to be implemented.\n */\nexport default class Transport {\n    exchangeTimeout = 30000;\n    unresponsiveTimeout = 15000;\n    deviceModel = null;\n    tracer;\n    constructor({ context, logType } = {}) {\n        this.tracer = new LocalTracer(logType ?? DEFAULT_LOG_TYPE, context);\n    }\n    /**\n     * Check if the transport is supported on the current platform/browser.\n     * @returns {Promise<boolean>} A promise that resolves with a boolean indicating support.\n     */\n    static isSupported;\n    /**\n     * List all available descriptors for the transport.\n     * For a better granularity, checkout `listen()`.\n     *\n     * @returns {Promise<Array<any>>} A promise that resolves with an array of descriptors.\n     * @example\n     * TransportFoo.list().then(descriptors => ...)\n     */\n    static list;\n    /**\n     * Listen for device events for the transport. The method takes an observer of DescriptorEvent and returns a Subscription.\n     * A DescriptorEvent is an object containing a \"descriptor\" and a \"type\" field. The \"type\" field can be \"add\" or \"remove\", and the \"descriptor\" field can be passed to the \"open\" method.\n     * The \"listen\" method will first emit all currently connected devices and then will emit events as they occur, such as when a USB device is plugged in or a Bluetooth device becomes discoverable.\n     * @param {Observer<DescriptorEvent<any>>} observer - An object with \"next\", \"error\", and \"complete\" functions, following the observer pattern.\n     * @returns {Subscription} A Subscription object on which you can call \".unsubscribe()\" to stop listening to descriptors.\n     * @example\n    const sub = TransportFoo.listen({\n    next: e => {\n      if (e.type===\"add\") {\n        sub.unsubscribe();\n        const transport = await TransportFoo.open(e.descriptor);\n        ...\n      }\n    },\n    error: error => {},\n    complete: () => {}\n    })\n     */\n    static listen;\n    /**\n     * Attempt to create a Transport instance with a specific descriptor.\n     * @param {any} descriptor - The descriptor to open the transport with.\n     * @param {number} timeout - An optional timeout for the transport connection.\n     * @param {TraceContext} context Optional tracing/log context\n     * @returns {Promise<Transport>} A promise that resolves with a Transport instance.\n     * @example\n    TransportFoo.open(descriptor).then(transport => ...)\n     */\n    static open;\n    /**\n     * Send data to the device using a low level API.\n     * It's recommended to use the \"send\" method for a higher level API.\n     * @param {Buffer} apdu - The data to send.\n     * @param {Object} options - Contains optional options for the exchange function\n     *  - abortTimeoutMs: stop the exchange after a given timeout. Another timeout exists\n     *    to detect unresponsive device (see `unresponsiveTimeout`). This timeout aborts the exchange.\n     * @returns {Promise<Buffer>} A promise that resolves with the response data from the device.\n     */\n    exchange(_apdu, { abortTimeoutMs: _abortTimeoutMs } = {}) {\n        throw new Error(\"exchange not implemented\");\n    }\n    /**\n     * Send apdus in batch to the device using a low level API.\n     * The default implementation is to call exchange for each apdu.\n     * @param {Array<Buffer>} apdus - array of apdus to send.\n     * @param {Observer<Buffer>} observer - an observer that will receive the response of each apdu.\n     * @returns {Subscription} A Subscription object on which you can call \".unsubscribe()\" to stop sending apdus.\n     */\n    exchangeBulk(apdus, observer) {\n        let unsubscribed = false;\n        const unsubscribe = () => {\n            unsubscribed = true;\n        };\n        const main = async () => {\n            if (unsubscribed)\n                return;\n            for (const apdu of apdus) {\n                const r = await this.exchange(apdu);\n                if (unsubscribed)\n                    return;\n                const status = r.readUInt16BE(r.length - 2);\n                if (status !== StatusCodes.OK) {\n                    throw new TransportStatusError(status);\n                }\n                observer.next(r);\n            }\n        };\n        main().then(() => !unsubscribed && observer.complete(), e => !unsubscribed && observer.error(e));\n        return { unsubscribe };\n    }\n    /**\n     * Set the \"scramble key\" for the next data exchanges with the device.\n     * Each app can have a different scramble key and it is set internally during instantiation.\n     * @param {string} key - The scramble key to set.\n     * deprecated This method is no longer needed for modern transports and should be migrated away from.\n     * no @ before deprecated as it breaks documentationjs on version 14.0.2\n     * https://github.com/documentationjs/documentation/issues/1596\n     */\n    setScrambleKey(_key) { }\n    /**\n     * Close the connection with the device.\n     *\n     * Note: for certain transports (hw-transport-node-hid-singleton for ex), once the promise resolved,\n     * the transport instance is actually still cached, and the device is disconnected only after a defined timeout.\n     * But for the consumer of the Transport, this does not matter and it can consider the transport to be closed.\n     *\n     * @returns {Promise<void>} A promise that resolves when the transport is closed.\n     */\n    close() {\n        return Promise.resolve();\n    }\n    _events = new EventEmitter();\n    /**\n     * Listen for an event on the transport instance.\n     * Transport implementations may have specific events. Common events include:\n     * \"disconnect\" : triggered when the transport is disconnected.\n     * @param {string} eventName - The name of the event to listen for.\n     * @param {(...args: Array<any>) => any} cb - The callback function to be invoked when the event occurs.\n     */\n    on(eventName, cb) {\n        this._events.on(eventName, cb);\n    }\n    /**\n     * Stop listening to an event on an instance of transport.\n     */\n    off(eventName, cb) {\n        this._events.removeListener(eventName, cb);\n    }\n    emit(event, ...args) {\n        this._events.emit(event, ...args);\n    }\n    /**\n     * Enable or not logs of the binary exchange\n     */\n    setDebugMode() {\n        console.warn(\"setDebugMode is deprecated. use @ledgerhq/logs instead. No logs are emitted in this anymore.\");\n    }\n    /**\n     * Set a timeout (in milliseconds) for the exchange call. Only some transport might implement it. (e.g. U2F)\n     */\n    setExchangeTimeout(exchangeTimeout) {\n        this.exchangeTimeout = exchangeTimeout;\n    }\n    /**\n     * Define the delay before emitting \"unresponsive\" on an exchange that does not respond\n     */\n    setExchangeUnresponsiveTimeout(unresponsiveTimeout) {\n        this.unresponsiveTimeout = unresponsiveTimeout;\n    }\n    /**\n     * Send data to the device using the higher level API.\n     *\n     * @param {number} cla - The instruction class for the command.\n     * @param {number} ins - The instruction code for the command.\n     * @param {number} p1 - The first parameter for the instruction.\n     * @param {number} p2 - The second parameter for the instruction.\n     * @param {Buffer} data - The data to be sent. Defaults to an empty buffer.\n     * @param {Array<number>} statusList - A list of acceptable status codes for the response. Defaults to [StatusCodes.OK].\n     * @param {Object} options - Contains optional options for the exchange function\n     *  - abortTimeoutMs: stop the send after a given timeout. Another timeout exists\n     *    to detect unresponsive device (see `unresponsiveTimeout`). This timeout aborts the exchange.\n     * @returns {Promise<Buffer>} A promise that resolves with the response data from the device.\n     */\n    send = async (cla, ins, p1, p2, data = Buffer.alloc(0), statusList = [StatusCodes.OK], { abortTimeoutMs } = {}) => {\n        const tracer = this.tracer.withUpdatedContext({ function: \"send\" });\n        if (data.length >= 256) {\n            tracer.trace(\"data.length exceeded 256 bytes limit\", { dataLength: data.length });\n            throw new TransportError(\"data.length exceed 256 bytes limit. Got: \" + data.length, \"DataLengthTooBig\");\n        }\n        const response = await this.exchange(\n        // The size of the data is added in 1 byte just before `data`\n        Buffer.concat([Buffer.from([cla, ins, p1, p2]), Buffer.from([data.length]), data]), { abortTimeoutMs });\n        const sw = response.readUInt16BE(response.length - 2);\n        if (!statusList.some(s => s === sw)) {\n            throw new TransportStatusError(sw);\n        }\n        return response;\n    };\n    /**\n     * create() allows to open the first descriptor available or\n     * throw if there is none or if timeout is reached.\n     * This is a light helper, alternative to using listen() and open() (that you may need for any more advanced usecase)\n     * @example\n    TransportFoo.create().then(transport => ...)\n     */\n    static create(openTimeout = 3000, listenTimeout) {\n        return new Promise((resolve, reject) => {\n            let found = false;\n            const sub = this.listen({\n                next: e => {\n                    found = true;\n                    if (sub)\n                        sub.unsubscribe();\n                    if (listenTimeoutId)\n                        clearTimeout(listenTimeoutId);\n                    this.open(e.descriptor, openTimeout).then(resolve, reject);\n                },\n                error: e => {\n                    if (listenTimeoutId)\n                        clearTimeout(listenTimeoutId);\n                    reject(e);\n                },\n                complete: () => {\n                    if (listenTimeoutId)\n                        clearTimeout(listenTimeoutId);\n                    if (!found) {\n                        reject(new TransportError(this.ErrorMessage_NoDeviceFound, \"NoDeviceFound\"));\n                    }\n                },\n            });\n            const listenTimeoutId = listenTimeout\n                ? setTimeout(() => {\n                    sub.unsubscribe();\n                    reject(new TransportError(this.ErrorMessage_ListenTimeout, \"ListenTimeout\"));\n                }, listenTimeout)\n                : null;\n        });\n    }\n    // Blocks other exchange to happen concurrently\n    exchangeBusyPromise;\n    /**\n     * Wrapper to make an exchange \"atomic\" (blocking any other exchange)\n     *\n     * It also handles \"unresponsiveness\" by emitting \"unresponsive\" and \"responsive\" events.\n     *\n     * @param f The exchange job, using the transport to run\n     * @returns a Promise resolving with the output of the given job\n     */\n    async exchangeAtomicImpl(f) {\n        const tracer = this.tracer.withUpdatedContext({\n            function: \"exchangeAtomicImpl\",\n            unresponsiveTimeout: this.unresponsiveTimeout,\n        });\n        if (this.exchangeBusyPromise) {\n            tracer.trace(\"Atomic exchange is already busy\");\n            throw new TransportRaceCondition(\"An action was already pending on the Ledger device. Please deny or reconnect.\");\n        }\n        // Sets the atomic guard\n        let resolveBusy;\n        const busyPromise = new Promise(r => {\n            resolveBusy = r;\n        });\n        this.exchangeBusyPromise = busyPromise;\n        // The device unresponsiveness handler\n        let unresponsiveReached = false;\n        const timeout = setTimeout(() => {\n            tracer.trace(`Timeout reached, emitting Transport event \"unresponsive\"`, {\n                unresponsiveTimeout: this.unresponsiveTimeout,\n            });\n            unresponsiveReached = true;\n            this.emit(\"unresponsive\");\n        }, this.unresponsiveTimeout);\n        try {\n            const res = await f();\n            if (unresponsiveReached) {\n                tracer.trace(\"Device was unresponsive, emitting responsive\");\n                this.emit(\"responsive\");\n            }\n            return res;\n        }\n        finally {\n            tracer.trace(\"Finalize, clearing busy guard\");\n            clearTimeout(timeout);\n            if (resolveBusy)\n                resolveBusy();\n            this.exchangeBusyPromise = null;\n        }\n    }\n    decorateAppAPIMethods(self, methods, scrambleKey) {\n        for (const methodName of methods) {\n            self[methodName] = this.decorateAppAPIMethod(methodName, self[methodName], self, scrambleKey);\n        }\n    }\n    _appAPIlock = null;\n    decorateAppAPIMethod(methodName, f, ctx, scrambleKey) {\n        return async (...args) => {\n            const { _appAPIlock } = this;\n            if (_appAPIlock) {\n                return Promise.reject(new TransportError(\"Ledger Device is busy (lock \" + _appAPIlock + \")\", \"TransportLocked\"));\n            }\n            try {\n                this._appAPIlock = methodName;\n                this.setScrambleKey(scrambleKey);\n                return await f.apply(ctx, args);\n            }\n            finally {\n                this._appAPIlock = null;\n            }\n        };\n    }\n    /**\n     * Sets the context used by the logging/tracing mechanism\n     *\n     * Useful when re-using (cached) the same Transport instance,\n     * but with a new tracing context.\n     *\n     * @param context A TraceContext, that can undefined to reset the context\n     */\n    setTraceContext(context) {\n        this.tracer = this.tracer.withContext(context);\n    }\n    /**\n     * Updates the context used by the logging/tracing mechanism\n     *\n     * The update only overrides the key-value that are already defined in the current context.\n     *\n     * @param contextToAdd A TraceContext that will be added to the current context\n     */\n    updateTraceContext(contextToAdd) {\n        this.tracer.updateContext(contextToAdd);\n    }\n    /**\n     * Gets the tracing context of the transport instance\n     */\n    getTraceContext() {\n        return this.tracer.getContext();\n    }\n    static ErrorMessage_ListenTimeout = \"No Ledger device found (timeout)\";\n    static ErrorMessage_NoDeviceFound = \"No Ledger device found\";\n}\n//# sourceMappingURL=Transport.js.map"],"mappings":"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"}